import os
import sys
import cv2
import numpy as np
import time
import torch
from ultralytics import YOLOE
from ultralytics.models.yolo.yoloe import YOLOEVPSegPredictor

# 添加CLIP-main目录到Python路径
clip_path = "D:\\portfolio\\table-scenes\\CLIP-main"
if os.path.exists(clip_path):
    sys.path.append(clip_path)
    print(f"已添加CLIP库路径: {clip_path}")
else:
    print(f"错误: CLIP库路径不存在: {clip_path}")
    exit(1)

# 初始化YOLOE模型
model_path = "D:\\portfolio\\table-scenes\\yoloe-11l-seg.pt"
if not os.path.exists(model_path):
    print(f"错误: 模型文件不存在: {model_path}")
    exit(1)

print(f"加载模型: {model_path}")
model = YOLOE(model_path)

# Configure the set_classes() before exporting the model
names = ["person", "keyboard"]
model.set_classes(names, model.get_text_pe(names))

export_model = model.export(format="onnx")
model = YOLOE(export_model)

# Run detection on the given image
results = model.predict(source=1)

# Show results
results[0].show()